/*
 * SmarTicker Version 1.5
 * http://powerup.ir/projects/smarticker
 * Copyright (c) 2014 Meghdad Hadidi
 */
 !function(e){e.fn.smarticker=function(a){var t=e.extend({pause:0,maxWidth:0,el:e(this),timeouts:[],nx:"start",newsRollerIndex:0,lastIndex:99999,clearTimeouts:function(){for(var a=0,s=t.timeouts.length;s>a;a++)clearTimeout(t.timeouts[a]);t.timeouts=[],e("*",t.el).clearQueue()}},e.fn.smarticker.defaults,a);return this.each(function(a){function s(){var a=e.trim(b[C]);0!=t.category?void 0!=I[C]?I[C]='data-category="'+I[C]+'"':I[C]='data-category="Rss"':I[C]="",0!=t.subcategory?void 0!=k[C]?k[C]='data-subcategory="'+k[C]+'"':k[C]='data-subcategory="Feed"':k[C]="",void 0!=R[C]?R[C]='data-color="'+R[C]+'"':R[C]='data-color="c3c3c3"';var i=g;g.find("ul").length>0&&(i=g.find("ul")),0==g.find("ul").length&&(i.append("<ul></ul>"),i=g.find("ul")),""==t.feedLoader&&(t.googleApi=!0),g.addClass("google-api");var l,o=window.location.protocol+"//ajax.googleapis.com/ajax/services/feed/load?v=1.0&num="+t.rssLimit+"&callback=?&q="+encodeURIComponent(a);t.googleApi&&""==t.feedLoader||(g.removeClass("google-api").addClass("feed-loader"),o=t.feedLoader,l={siteurl:a,limit:t.rssLimit}),e.ajax({type:"GET",url:o,data:l,dataType:"json",beforeSend:function(){e(".loading",g).text("Loading feed "+(C+1)+" of "+b.length)},error:function(){m("Unable to load feed, Incorrect path or invalid feed")},success:function(a){var i;if(i=t.googleApi&&""==t.feedLoader?a.responseData?a.responseData.feed.entries:[]:a.item,i.length)e.each(i,function(a,l){var l=e(this)[0],o=e('<li style="display:none" '+R[C]+" "+k[C]+" "+I[C]+'><a target="'+t.linkTarget+'" href="'+l.link+'"></a></li>');o.find("a").text(l.title);var n,d=g;(void 0!=l.pubdate||""!=l.pubdate||NaN!=l.pubdate)&&(n=l.pubdate),n=new Date(n);var c=Array("January","February","March","April","May","June","July","August","September","October","November","December"),u=n.getDate()+" "+c[n.getMonth()]+" "+n.getFullYear();(""!=t.showDate||0!=t.showDate&&void 0!=l.pubdate)&&e('<span class="item-date">'+u+"</span>").appendTo(o),g.find("ul").length>0&&(d=g.find("ul")),"older"==t.feedsOrder?o.appendTo(d):o.prependTo(d),a==i.length-1&&(C==b.length-1?(e(".loading",g).fadeOut(200,function(){e(".loading",g).remove()}),r()):(C++,s()))});else{var l=t.googleApi?"Google":t.feedLoader?"Php":"";e(".loading",g).text(l+" feed reader is not responding!"),m("Detail:"+a.responseDetails)}}})}function r(){x=e("li",g),g.addClass("smarticker").wrapInner('<div class="smarticker-news"></div>'),t.shuffle&&e("li",g).randomize(),i(x,"subcategory").length<1&&(t.subcategory=!1),i(x,"category").length<1&&(t.category=!1),1==t.subcategory&&(h.prependTo(g).addClass("sec1-2"),e.each(i(x,"subcategory"),function(e,a){var s=a;(-1!=a.indexOf(".png")||-1!=a.indexOf(".jpg")||-1!=a.indexOf(".gif"))&&(s='<img src="'+t.imagesPath+a+'" />'),h.find("ul").append('<li data-subcategory="'+a+'"><a>'+s+"</a></li>")}),(1==t.theme||2==t.theme)&&(h.find("ul").wrap('<div class="catlist"></div>'),h.append('<span class="right"></span>').prepend('<span class="left"></span>'))),1==t.category&&i(x,"category").length>0&&(f.prependTo(g).addClass("sec1-2"),e.each(i(x,"category"),function(e,a){var s=a;(-1!=a.indexOf(".png")||-1!=a.indexOf(".jpg")||-1!=a.indexOf(".gif"))&&(s='<img src="'+t.imagesPath+a+'" />'),f.find("ul").append('<li data-category="'+a+'"><a>'+s+"</a></li>")})),"horizontal"==t.layout&&(1==t.progressbar&&y.appendTo(e(".smarticker-news",g)),0!=t.controllerType&&v.appendTo(g),0==t.category&&g.addClass("no-category"),0==t.subcategory&&g.addClass("no-subcategory"),g.addClass("theme"+t.theme),g.addClass("box size1"),g.addClass("c"+t.controllerType),g.addClass("s-"+t.direction),e(".smarticker-news",g).addClass("sec7 newsholder"),e(".smarticker-news > ul",g).attr("id","newsholder").addClass("newsholder"),1==t.rounded&&g.addClass("rounded"),"rtl"==t.direction&&g.addClass("rtl"),1==t.border&&g.addClass("border"),1==t.shadow&&g.addClass("shadow"),1==t.googleFont&&g.addClass("googlefont"),(0==t.category||0==t.subcategory)&&e(".smarticker-news",g).removeClass("sec7").addClass("sec10"),0==t.category&&0==t.subcategory&&1==t.titlesection&&(e(".smarticker-news",g).removeClass("sec7").addClass("sec10"),w.prependTo(g).text(t.title)),n(),e(".next-news",g).on("click",function(){return x.length<2?!1:(t.pause=1,t.nx="next",t.clearTimeouts(),n(),void(e(".pause-news").hasClass("play-news")||(t.pause=0)))}),e(".prev-news",g).on("click",function(){return x.length<2?!1:(t.pause=1,t.nx="prev",t.clearTimeouts(),n(),t.nx="next",void(e(".pause-news").hasClass("play-news")||(t.pause=0)))}),e(".pause-news",g).on("click",function(){return x.length<2?!1:void(e(this).hasClass("play-news")?(t.pause=0,n(),e(this).removeClass("play-news").text("Pause")):(t.clearTimeouts(),t.pause=1,e(this).addClass("play-news").text("Play")))})),m("vertical"==t.layout?"Excuse me! Vertical layout is not available in this version, Please use Horizontal layout!":"Layout type not valid! It must be Vertical Or Horizontal")}function i(a,t){var s=[];return e.each(a,function(a,r){-1==e.inArray(e(r).data(t),s)&&void 0!=e(r).data(t)&&s.push(e(r).data(t))}),l(s)}function l(e){for(var a,t,s=e.length;s;a=parseInt(Math.random()*s),t=e[--s],e[s]=e[a],e[a]=t);return e}function o(){return x.length<2?!1:("start"!=t.nx&&(t.lastIndex=t.newsRollerIndex),t.nx&&"next"!=t.nx&&"start"!=t.nx||("start"!=t.nx&&t.newsRollerIndex++,t.newsRollerIndex==e(".newsholder",g).find("li").length&&(t.newsRollerIndex=0),t.nx="next"),void(t.nx&&"prev"==t.nx&&(t.newsRollerIndex--,-1==t.newsRollerIndex&&(t.newsRollerIndex=e(".newsholder",g).find("li").length-1))))}function n(){if(o(),t.clearTimeouts(),0==t.category||e(".smarticker-news ul li",g).eq(t.lastIndex).data("category")==e(".smarticker-news ul li",g).eq(t.newsRollerIndex).data("category"))d();else{e(".active-ag",g).removeClass("active-ag");var a=e(".newsholder li",g).eq(t.newsRollerIndex).data("category");a=e(".smarticker-category ul li",g).index(e('.smarticker-category ul li[data-category="'+a+'"]',g)),e(".smarticker-category ul li",g).eq(a).addClass("active-ag"),a=e(".active-ag",g),e(".smarticker-category",g).animate({scrollTop:a.offset().top-a.parent().offset().top+a.parent().scrollTop()},t.speed-t.speed/2.5,function(){0!=t.subcategory?d():c();var a=e(".newsholder",g).find("li").eq(t.newsRollerIndex).data("color");void 0!=a&&0!=t.catcolor?e(".active-ag a",g).stop().animate({color:"#"+a},t.speed-t.speed/2.5):e(".active-ag a",g).stop().animate({color:"#999"},t.speed-t.speed/2.5)})}}function d(){if((0==t.subcategory||e(".smarticker-news ul li",g).eq(t.lastIndex).data("subcategory")==e(".smarticker-news ul li",g).eq(t.newsRollerIndex).data("subcategory"))&&(m("Last index subcategory: "+t.lastIndex+"="+e(".smarticker-news ul li",g).eq(t.lastIndex).data("subcategory")),m("This subcategory: "+t.newsRollerIndex+"="+e(".smarticker-news ul li",g).eq(t.newsRollerIndex).data("subcategory")),e(".smarticker-news ul li",g).eq(t.newsRollerIndex).data("color")==e(".smarticker-news ul li",g).eq(t.lastIndex).data("color")))return c(),!1;e(".active-cat",g).removeClass("active-cat");var a=e(".newsholder li",g).eq(t.newsRollerIndex).data("subcategory");a=e(".smarticker-cats li",g).index(e('.smarticker-cats li[data-subcategory="'+a+'"]',g)),e(".smarticker-cats ul li",g).eq(a).addClass("active-cat"),a=e(".active-cat",g);var s=a.parent();s=e(".catlist",g).length>0?e(".catlist",g):e(".smarticker-cats",g),s.animate({scrollTop:Math.max(a.offset().top-s.offset().top+s.scrollTop(),0)},t.speed-t.speed/2.5,c);var r=e(".newsholder",g).find("li").eq(t.newsRollerIndex).data("color");void 0!=r&&0!=t.subcatcolor?e(".smarticker-cats li",g).animate({backgroundColor:"#"+r},t.speed-t.speed/2.5):e(".smarticker-cats li",g).animate({backgroundColor:"#c3c3c3"},t.speed-t.speed/2.5)}function c(){if(e(".newsholder",g).css({display:"block",height:"100%"}),y.css("width","100%").animate({width:0},t.pausetime),"default"==t.animation){if(e(".activeRollerItem",g).length>0){var a=e(".activeRollerItem",g);a.animate({top:-25,opacity:0},t.speed-t.speed/1.2,function(){a.css("display","none")}).removeClass("activeRollerItem")}var s=e(".newsholder",g).find("li").eq(t.newsRollerIndex).addClass("activeRollerItem");s.css({top:"25px",display:"block"}).animate({opacity:1,top:0},t.speed-t.speed/2.5,function(){u()})}if("slide"==t.animation)if("ltr"==t.direction){e(".activeRollerItem",g).length>0&&(a=e(".activeRollerItem",g),a.animate({left:250,opacity:0},t.speed-t.speed/1.5,function(){a.css("display","none")}).removeClass("activeRollerItem"));var s=e(".newsholder li",g).eq(t.newsRollerIndex).addClass("activeRollerItem");s.css({left:"-150px",display:"block",opacity:"1"}).animate({opacity:1,left:10},t.speed-t.speed/3,function(){u()})}else{e(".activeRollerItem",g).length>0&&(a=e(".activeRollerItem",g),a.animate({right:250,opacity:0},t.speed-t.speed/1.5,function(){a.css("display","none")}).removeClass("activeRollerItem"));var s=e(".newsholder li",g).eq(t.newsRollerIndex).addClass("activeRollerItem");s.css({right:"-150px",display:"block",opacity:"1"}).animate({opacity:1,right:10},t.speed-t.speed/3,function(){u()})}if("fade"==t.animation){e(".activeRollerItem",g).length>0&&(a=e(".activeRollerItem",g),a.fadeOut(t.speed/2,function(){a.removeClass("activeRollerItem")}));var s=e(".newsholder li",g).eq(t.newsRollerIndex).addClass("activeRollerItem");s.css({top:"0",display:"none"}).fadeIn(t.speed/2,function(){u()})}if("typing"==t.animation)if(e(".activeRollerItem",g).length>0){a=e(".activeRollerItem",g);var r=e('<div class="hider"></div>'),i="left";"rtl"==t.direction&&(i="right"),r.prependTo(e(".smarticker-news",g)).css({width:"0px",dir:"0px",height:"100%",position:"absolute","background-color":g.css("background-color"),"z-index":"2"}),r.animate({width:a.width()+30},t.speed,function(){a.fadeOut(100,function(){a.css("opacity","0").removeClass("activeRollerItem"),r.fadeOut(100,function(){var a=e(".newsholder li",g).eq(t.newsRollerIndex).addClass("activeRollerItem").css({display:"block",opacity:"1"});r.remove();var s=e('<div class="cover"><div class="flasher">_</div></div>');s.prependTo(e(".smarticker-news",g)),s.css({"background-color":g.css("background-color")}),"ltr"==t.direction?s.animate({left:a.width()+30},8*a.width(),function(){s.remove(),u()}):s.animate({right:a.width()+30},8*a.width(),function(){s.remove(),u()})})})})}else{var s=e(".newsholder li",g).eq(t.newsRollerIndex).addClass("activeRollerItem").css({display:"block",opacity:"1"}),l=e('<div class="cover"><div class="flasher">_</div></div>');l.prependTo(e(".smarticker-news",g)),l.css({"background-color":g.css("background-color")}),"ltr"==t.direction?l.animate({left:s.width()+30},8*s.width(),function(){l.remove(),0==t.pause&&u()}):l.animate({right:s.width()+30},8*s.width(),function(){l.remove(),0==t.pause&&u()})}}function u(){if(t.maxWidth=0,t.maxWidth=g.width(),t.maxWidth=t.maxWidth-e(".smarticker-cats",g).width(),t.maxWidth=t.maxWidth-e(".smarticker-category",g).width(),0!=t.smartController&&(t.maxWidth=t.maxWidth-e(".smart-controller",g).width()),m("element: "+e(".activeRollerItem",g).width()),m("max: "+t.maxWidth),e(".activeRollerItem",g).width()>t.maxWidth)t.maxWidth=e(".activeRollerItem",g).width()-t.maxWidth+10,e(".activeRollerItem",g).css("display","block"),"rtl"==t.direction?e(".activeRollerItem",g).css("left","auto").animate({right:10},250).delay(1e3).animate({right:-t.maxWidth},30*t.maxWidth,function(){e(".activeRollerItem",g).delay(1e3).animate({right:10},300,function(){return x.length<2?!1:void p()})}):e(".activeRollerItem",g).animate({left:10},250).delay(1e3).animate({left:-t.maxWidth},30*t.maxWidth,function(){e(".activeRollerItem",g).delay(1e3).animate({left:10},300,function(){return x.length<2?!1:void p()})});else{if(x.length<2)return!1;p()}}function p(){1!=t.pause&&t.timeouts.push(setTimeout(n,t.pausetime))}function m(e){1==t.developerMode&&console.log(e)}var g=e(this),h=e('<div class="smarticker-cats"><ul></ul></div>'),f=e('<div class="smarticker-category"><ul></ul></div>');t.newsRollerIndex=t.startindex;var v=e('<div class="smart-controller"><span class="prev-news">Previous</span><span class="pause-news">Pause</span><span class="next-news">Next</span></div>').css("background",g.css("background")),y=e('<div class="progress-bar"></div>'),w=e('<div class="sec1-2 tickertitle"></div>'),x=e("li",g);if(e("li",g).css("display","none"),""!=e.trim(t.rssFeed)){g.append('<div class="loading" Style="text-align:center;color:#666;font-size:12px">Loading Rss feed, Please wait ...</div>');var b=t.rssFeed.split(","),I=[],k=[],R=[];t.rssCats&&(k=t.rssCats.split(",")),t.rssSources&&(I=t.rssSources.split(",")),t.rssColors&&(R=t.rssColors.split(",")),"/"!=t.imagesPath[t.imagesPath.length-1]&&""!=t.imagesPath&&(t.imagesPath=t.imagesPath+"/");var C=0;s()}else r()})},e.fn.smarticker.defaults={theme:1,direction:"ltr",layout:"horizontal",animation:"default",speed:1e3,startindex:0,pausetime:3e3,rounded:!1,shadow:!0,border:!1,category:!0,subcategory:!0,titlesection:!0,title:"Headlines",progressbar:!1,catcolor:!0,subcatcolor:!0,shuffle:!1,rssFeed:"",rssLimit:10,rssCats:"",rssSources:"",rssColors:"",showDate:!1,googleApi:!0,feedLoader:"",feedsOrder:"older",linkTarget:"_blank",controllerType:!1,googleFont:!0,imagesPath:"",developerMode:!1}}(jQuery),function(e){e.fn.randomize=function(){var a=this.get(),t=function(e){return Math.floor(Math.random()*e)},s=e.map(a,function(){var s=t(a.length),r=e(a[s]).clone(!0)[0];return a.splice(s,1),r});return this.each(function(a){e(this).replaceWith(e(s[a]))}),e(s)}}(jQuery);
